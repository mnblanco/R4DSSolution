<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Data Science Solutions</title>
  <meta name="description" content="R for Data Science Solutions">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R for Data Science Solutions" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Data Science Solutions" />
  
  
  

<meta name="author" content="Marjorie Blanco">


<meta name="date" content="2018-10-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="tidy-data.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="r4ds.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Data Science</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>2</b> Tibble</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble.html"><a href="tibble.html#exercises"><i class="fa fa-check"></i><b>2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>3</b> Data Import</a><ul>
<li class="chapter" data-level="3.1" data-path="data-import.html"><a href="data-import.html#exercises-1"><i class="fa fa-check"></i><b>3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.2" data-path="data-import.html"><a href="data-import.html#exercises-2"><i class="fa fa-check"></i><b>3.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>4</b> Tidy data</a><ul>
<li class="chapter" data-level="4.1" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.2.1"><i class="fa fa-check"></i><b>4.1</b> Exercises 12.2.1</a></li>
<li class="chapter" data-level="4.2" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.3.3"><i class="fa fa-check"></i><b>4.2</b> Exercises 12.3.3</a></li>
<li class="chapter" data-level="4.3" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.4.3"><i class="fa fa-check"></i><b>4.3</b> Exercises 12.4.3</a></li>
<li class="chapter" data-level="4.4" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.5.1"><i class="fa fa-check"></i><b>4.4</b> Exercises 12.5.1</a></li>
<li class="chapter" data-level="4.5" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.6.1"><i class="fa fa-check"></i><b>4.5</b> Exercises 12.6.1</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="relational-data.html"><a href="relational-data.html"><i class="fa fa-check"></i><b>5</b> Relational data</a><ul>
<li class="chapter" data-level="5.1" data-path="relational-data.html"><a href="relational-data.html#exercises-3"><i class="fa fa-check"></i><b>5.1</b> Exercises</a></li>
<li class="chapter" data-level="5.2" data-path="relational-data.html"><a href="relational-data.html#exercises-13.3.1"><i class="fa fa-check"></i><b>5.2</b> Exercises 13.3.1</a></li>
<li class="chapter" data-level="5.3" data-path="relational-data.html"><a href="relational-data.html#exercises-13.4.6"><i class="fa fa-check"></i><b>5.3</b> Exercises 13.4.6</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Science Solutions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="relational-data" class="section level1">
<h1><span class="header-section-number">5</span> Relational data</h1>
<div id="exercises-3" class="section level2">
<h2><span class="header-section-number">5.1</span> Exercises</h2>
<p>Imagine you wanted to draw (approximately) the route each plane flies from its origin to its destination. What variables would you need? What tables would you need to combine?</p>
<ul>
<li><code>flights</code> table: <code>origin</code> and <code>dest</code> variables</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">head</span>(flights <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(origin, dest))</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 2</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;   origin dest </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;  &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 1 EWR    IAH  </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 2 LGA    IAH  </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 3 JFK    MIA  </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 4 JFK    BQN  </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 5 LGA    ATL  </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 6 EWR    ORD</span></a></code></pre></div>
<ul>
<li><code>airports</code> table: faa (matches the origin and destination), longitude and latitude variables</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">head</span>(airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(lon, lat, faa))</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;     lon   lat faa  </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 1 -80.6  41.1 04G  </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 2 -85.7  32.5 06A  </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 3 -88.1  42.0 06C  </span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 4 -74.4  41.4 06N  </span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; 5 -81.4  31.1 09J  </span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 6 -82.2  36.4 0A9</span></a></code></pre></div>
<ul>
<li>join <code>flights</code> with <code>airports</code>. The first join adds the location of the origin airport (<code>origin</code>) and the second join adds the location of destination airport (<code>dest</code>).</li>
</ul>
<p>I forgot to draw the relationship between weather and airports. What is the relationship and how should it appear in the diagram?</p>
<p>The variable <code>origin</code> in <code>weather</code> is the same as <code>faa</code> in <code>airports</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">head</span>(weather <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(origin))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 1</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;   origin</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt; </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 1 EWR   </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 2 EWR   </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 3 EWR   </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 4 EWR   </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 5 EWR   </span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 6 EWR</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw">head</span>(airports <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(faa) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(faa <span class="op">==</span><span class="st"> &quot;EWR&quot;</span>))</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; # A tibble: 1 x 1</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">#&gt;   faa  </span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">#&gt;   &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">#&gt; 1 EWR</span></a></code></pre></div>
<p><code>weather</code> only contains information for the origin (NYC) airports. If it contained weather records for all airports in the USA, what additional relation would it define with flights?</p>
<p><code>origin</code> would need to change to <code>location</code>
<code>year</code>, <code>month</code>, <code>day</code>, <code>hour</code>, <code>origin</code> in <code>weather</code> should match to <code>year</code>, <code>month</code>, <code>day</code>, <code>arr_time</code>, <code>dest</code> in <code>flight</code></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">head</span>(weather)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 15</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 </span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 </span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 </span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">#&gt; # ... with 5 more variables: wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">#&gt; #   pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="kw">head</span>(flights)</a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">#&gt; # A tibble: 6 x 19</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">#&gt; 1  2013     1     1      517            515         2      830</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co">#&gt; 2  2013     1     1      533            529         4      850</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19"><span class="co">#&gt; 3  2013     1     1      542            540         2      923</span></a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004</span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">#&gt; 5  2013     1     1      554            600        -6      812</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">#&gt; 6  2013     1     1      554            558        -4      740</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; # ... with 12 more variables: sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; #   carrier &lt;chr&gt;, flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;,</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt; #   air_time &lt;dbl&gt;, distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt; #   time_hour &lt;dttm&gt;</span></a></code></pre></div>
<p>We know that some days of the year are “special”, and fewer people than usual fly on them. How might you represent that data as a data frame? What would be the primary keys of that table? How would it connect to the existing tables?</p>
<p>The table <code>special_days</code> would contain a list of day where fewer people travel than usual.
Primary key: year, month, day should match <code>year</code>, <code>month</code>, and <code>day</code> in <code>flight</code></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">special_days &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="op">~</span>year, <span class="op">~</span>month, <span class="op">~</span>day, <span class="op">~</span>holiday,</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="dv">2019</span>, <span class="dv">01</span>, <span class="dv">01</span>, <span class="st">&quot;New Years Day&quot;</span>,</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  <span class="dv">2018</span>, <span class="dv">12</span>, <span class="dv">25</span>, <span class="st">&quot;Christmas Day&quot;</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">)</a></code></pre></div>
</div>
<div id="exercises-13.3.1" class="section level2">
<h2><span class="header-section-number">5.2</span> Exercises 13.3.1</h2>
<p>Add a surrogate key to flights.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">flights</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; # A tibble: 336,776 x 19</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">#&gt;    year month   day dep_time sched_dep_time dep_delay arr_time</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">#&gt; 1  2013     1     1      517            515         2      830</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">#&gt; 2  2013     1     1      533            529         4      850</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; 3  2013     1     1      542            540         2      923</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt; 4  2013     1     1      544            545        -1     1004</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 5  2013     1     1      554            600        -6      812</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 6  2013     1     1      554            558        -4      740</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; # ... with 3.368e+05 more rows, and 12 more variables:</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt; #   sched_arr_time &lt;int&gt;, arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">#&gt; #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">#&gt; #   distance &lt;dbl&gt;, hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"></a>
<a class="sourceLine" id="cb7-16" data-line-number="16">flights <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="st">  </span><span class="kw">arrange</span>(year, month, day, sched_dep_time, carrier, flight) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">flight_id =</span> <span class="kw">row_number</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="st">  </span><span class="kw">glimpse</span>()</a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="co">#&gt; Observations: 336,776</span></a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; Variables: 20</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; $ year           &lt;int&gt; 2013, 2013, 2013, 2013, 2013, 2013, 2013, 2013,...</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt; $ month          &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt; $ day            &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,...</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt; $ dep_time       &lt;int&gt; 517, 533, 542, 544, 554, 559, 558, 559, 558, 55...</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt; $ sched_dep_time &lt;int&gt; 515, 529, 540, 545, 558, 559, 600, 600, 600, 60...</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt; $ dep_delay      &lt;dbl&gt; 2, 4, 2, -1, -4, 0, -2, -1, -2, -2, -3, NA, 1, ...</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt; $ arr_time       &lt;int&gt; 830, 850, 923, 1004, 740, 702, 753, 941, 849, 8...</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt; $ sched_arr_time &lt;int&gt; 819, 830, 850, 1022, 728, 706, 745, 910, 851, 8...</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt; $ arr_delay      &lt;dbl&gt; 11, 20, 33, -18, 12, -4, 8, 31, -2, -3, -8, NA,...</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; $ carrier        &lt;chr&gt; &quot;UA&quot;, &quot;UA&quot;, &quot;AA&quot;, &quot;B6&quot;, &quot;UA&quot;, &quot;B6&quot;, &quot;AA&quot;, &quot;AA&quot;,...</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; $ flight         &lt;int&gt; 1545, 1714, 1141, 725, 1696, 1806, 301, 707, 49...</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="co">#&gt; $ tailnum        &lt;chr&gt; &quot;N14228&quot;, &quot;N24211&quot;, &quot;N619AA&quot;, &quot;N804JB&quot;, &quot;N39463...</span></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="co">#&gt; $ origin         &lt;chr&gt; &quot;EWR&quot;, &quot;LGA&quot;, &quot;JFK&quot;, &quot;JFK&quot;, &quot;EWR&quot;, &quot;JFK&quot;, &quot;LGA&quot;...</span></a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt; $ dest           &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;MIA&quot;, &quot;BQN&quot;, &quot;ORD&quot;, &quot;BOS&quot;, &quot;ORD&quot;...</span></a>
<a class="sourceLine" id="cb7-36" data-line-number="36"><span class="co">#&gt; $ air_time       &lt;dbl&gt; 227, 227, 160, 183, 150, 44, 138, 257, 149, 158...</span></a>
<a class="sourceLine" id="cb7-37" data-line-number="37"><span class="co">#&gt; $ distance       &lt;dbl&gt; 1400, 1416, 1089, 1576, 719, 187, 733, 1389, 10...</span></a>
<a class="sourceLine" id="cb7-38" data-line-number="38"><span class="co">#&gt; $ hour           &lt;dbl&gt; 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6,...</span></a>
<a class="sourceLine" id="cb7-39" data-line-number="39"><span class="co">#&gt; $ minute         &lt;dbl&gt; 15, 29, 40, 45, 58, 59, 0, 0, 0, 0, 0, 0, 0, 0,...</span></a>
<a class="sourceLine" id="cb7-40" data-line-number="40"><span class="co">#&gt; $ time_hour      &lt;dttm&gt; 2013-01-01 05:00:00, 2013-01-01 05:00:00, 2013...</span></a>
<a class="sourceLine" id="cb7-41" data-line-number="41"><span class="co">#&gt; $ flight_id      &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, ...</span></a>
<a class="sourceLine" id="cb7-42" data-line-number="42"></a>
<a class="sourceLine" id="cb7-43" data-line-number="43">flights <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-44" data-line-number="44"><span class="st">  </span><span class="kw">count</span>(year, month, day, sched_dep_time, carrier, flight) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-45" data-line-number="45"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-46" data-line-number="46"><span class="co">#&gt; # A tibble: 0 x 7</span></a>
<a class="sourceLine" id="cb7-47" data-line-number="47"><span class="co">#&gt; # ... with 7 variables: year &lt;int&gt;, month &lt;int&gt;, day &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb7-48" data-line-number="48"><span class="co">#&gt; #   sched_dep_time &lt;int&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;, n &lt;int&gt;</span></a></code></pre></div>
<p>Identify the keys in the following datasets</p>
<p>Lahman::Batting</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw">head</span>(Lahman<span class="op">::</span>Batting)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">#&gt;    playerID yearID stint teamID lgID  G  AB  R  H X2B X3B HR RBI SB CS BB</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">#&gt; 1 abercda01   1871     1    TRO   NA  1   4  0  0   0   0  0   0  0  0  0</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">#&gt; 2  addybo01   1871     1    RC1   NA 25 118 30 32   6   0  0  13  8  1  4</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; 3 allisar01   1871     1    CL1   NA 29 137 28 40   4   5  0  19  3  1  2</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt; 4 allisdo01   1871     1    WS3   NA 27 133 28 44  10   2  2  27  1  1  0</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; 5 ansonca01   1871     1    RC1   NA 25 120 29 39  11   3  0  16  6  2  2</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt; 6 armstbo01   1871     1    FW1   NA 12  49  9 11   2   1  0   5  0  1  0</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;   SO IBB HBP SH SF GIDP</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt; 1  0  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">#&gt; 2  0  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">#&gt; 3  5  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">#&gt; 4  2  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">#&gt; 5  1  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">#&gt; 6  1  NA  NA NA NA   NA</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16">Lahman<span class="op">::</span>Batting <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="st">  </span><span class="kw">count</span>(playerID, yearID, stint) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">#&gt; # A tibble: 0 x 4</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">#&gt; # ... with 4 variables: playerID &lt;chr&gt;, yearID &lt;int&gt;, stint &lt;int&gt;, n &lt;int&gt;</span></a></code></pre></div>
<p>babynames::babynames</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">head</span>(babynames<span class="op">::</span>babynames)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">#&gt;    year sex   name          n   prop</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">#&gt; 1  1880 F     Mary       7065 0.0724</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">#&gt; 2  1880 F     Anna       2604 0.0267</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">#&gt; 3  1880 F     Emma       2003 0.0205</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; 4  1880 F     Elizabeth  1939 0.0199</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt; 5  1880 F     Minnie     1746 0.0179</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt; 6  1880 F     Margaret   1578 0.0162</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11">babynames<span class="op">::</span>babynames <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="st">  </span><span class="kw">count</span>(year, sex, name) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="st">  </span><span class="kw">filter</span>(nn <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">#&gt; # A tibble: 0 x 4</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">#&gt; # ... with 4 variables: year &lt;dbl&gt;, sex &lt;chr&gt;, name &lt;chr&gt;, nn &lt;int&gt;</span></a></code></pre></div>
<p>nasaweather::atmos</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">head</span>(nasaweather<span class="op">::</span>atmos)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 11</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;     lat  long  year month surftemp  temp pressure ozone cloudlow cloudmid</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt; 1  36.2 -114.  1995     1     273.  272.      835   304      7.5     34.5</span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt; 2  33.7 -114.  1995     1     280.  282.      940   304     11.5     32.5</span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; 3  31.2 -114.  1995     1     285.  285.      960   298     16.5     26  </span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt; 4  28.7 -114.  1995     1     289.  291.      990   276     20.5     14.5</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; 5  26.2 -114.  1995     1     292.  293.     1000   274     26       10.5</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt; 6  23.7 -114.  1995     1     294.  294.     1000   264     30        9.5</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; # ... with 1 more variable: cloudhigh &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">nasaweather<span class="op">::</span>atmos <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="st">      </span><span class="kw">count</span>(lat, long, year, month) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="st">      </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; # A tibble: 0 x 5</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; # ... with 5 variables: lat &lt;dbl&gt;, long &lt;dbl&gt;, year &lt;int&gt;, month &lt;int&gt;,</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; #   n &lt;int&gt;</span></a></code></pre></div>
<p>fueleconomy::vehicles</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">head</span>(fueleconomy<span class="op">::</span>vehicles)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 12</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co">#&gt;      id make   model  year class trans drive   cyl displ fuel    hwy   cty</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;  &lt;chr&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt;</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co">#&gt; 1 27550 AM Ge… DJ P…  1984 Spec… Auto… 2-Wh…     4   2.5 Regu…    17    18</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; 2 28426 AM Ge… DJ P…  1984 Spec… Auto… 2-Wh…     4   2.5 Regu…    17    18</span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; 3 27549 AM Ge… FJ8c…  1984 Spec… Auto… 2-Wh…     6   4.2 Regu…    13    13</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; 4 28425 AM Ge… FJ8c…  1984 Spec… Auto… 2-Wh…     6   4.2 Regu…    13    13</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; 5  1032 AM Ge… Post…  1985 Spec… Auto… Rear…     4   2.5 Regu…    17    16</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; 6  1033 AM Ge… Post…  1985 Spec… Auto… Rear…     6   4.2 Regu…    13    13</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11">fueleconomy<span class="op">::</span>vehicles <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="st">      </span><span class="kw">count</span>(id) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="st">      </span><span class="kw">filter</span>(n <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14"><span class="co">#&gt; # A tibble: 0 x 2</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15"><span class="co">#&gt; # ... with 2 variables: id &lt;int&gt;, n &lt;int&gt;</span></a></code></pre></div>
<p>ggplot2::diamonds</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">head</span>(ggplot2<span class="op">::</span>diamonds)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 10</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt;   carat cut       color clarity depth table price     x     y     z</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="co">#&gt;   &lt;dbl&gt; &lt;ord&gt;     &lt;ord&gt; &lt;ord&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; 1 0.23  Ideal     E     SI2      61.5    55   326  3.95  3.98  2.43</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; 2 0.21  Premium   E     SI1      59.8    61   326  3.89  3.84  2.31</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; 3 0.23  Good      E     VS1      56.9    65   327  4.05  4.07  2.31</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; 4 0.290 Premium   I     VS2      62.4    58   334  4.2   4.23  2.63</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; 5 0.31  Good      J     SI2      63.3    58   335  4.34  4.35  2.75</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; 6 0.24  Very Good J     VVS2     62.8    57   336  3.94  3.96  2.48</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">ggplot2<span class="op">::</span>diamonds <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="st">  </span><span class="kw">distinct</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="st">  </span><span class="kw">nrow</span>()</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; [1] 53794</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="kw">nrow</span>(ggplot2<span class="op">::</span>diamonds)</a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="co">#&gt; [1] 53940</span></a></code></pre></div>
<p>(You might need to install some packages and read some documentation.)</p>
<p>Draw a diagram illustrating the connections between the Batting, Master, and Salaries tables in the Lahman package. Draw another diagram that shows the relationship between Master, Managers, AwardsManagers.</p>
<ul>
<li><p><code>Master</code></p>
<ul>
<li>Primary keys: <code>playerID</code></li>
</ul></li>
<li><p><code>Batting</code></p>
<ul>
<li><p>Primary keys: <code>yearID</code>, <code>yearID</code>, <code>stint</code></p></li>
<li><p>Foreign Keys:</p>
<ul>
<li><code>playerID</code> = <code>Master$playerID</code> (many-to-1)</li>
</ul></li>
</ul></li>
<li><p><code>Salaries</code></p>
<ul>
<li><p>Primary keys: <code>yearID</code>, <code>teamID</code>, <code>playerID</code></p></li>
<li><p>Foreign Keys</p>
<ul>
<li><code>playerID</code> = <code>Master$playerID</code> (many-to-1)</li>
</ul></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">dm1 &lt;-<span class="st"> </span><span class="kw">dm_from_data_frames</span>(<span class="kw">list</span>(<span class="dt">Batting =</span> Lahman<span class="op">::</span>Batting,</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                                <span class="dt">Master =</span> Lahman<span class="op">::</span>Master,</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                                <span class="dt">Salaries =</span> Lahman<span class="op">::</span>Salaries)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="st">  </span><span class="kw">dm_set_key</span>(<span class="st">&quot;Batting&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;playerID&quot;</span>, <span class="st">&quot;yearID&quot;</span>, <span class="st">&quot;stint&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="st">  </span><span class="kw">dm_set_key</span>(<span class="st">&quot;Master&quot;</span>, <span class="st">&quot;playerID&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="st">  </span><span class="kw">dm_set_key</span>(<span class="st">&quot;Salaries&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;yearID&quot;</span>, <span class="st">&quot;teamID&quot;</span>, <span class="st">&quot;playerID&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="st">  </span><span class="kw">dm_add_references</span>(</a>
<a class="sourceLine" id="cb13-8" data-line-number="8">    Batting<span class="op">$</span>playerID <span class="op">==</span><span class="st"> </span>Master<span class="op">$</span>playerID,</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">    Salaries<span class="op">$</span>playerID <span class="op">==</span><span class="st"> </span>Master<span class="op">$</span>playerID</a>
<a class="sourceLine" id="cb13-10" data-line-number="10">  )</a>
<a class="sourceLine" id="cb13-11" data-line-number="11"></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"><span class="kw">dm_create_graph</span>(dm1, <span class="dt">rankdir =</span> <span class="st">&quot;LR&quot;</span>, <span class="dt">columnArrows =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>How would you characterise the relationship between the Batting, Pitching, and Fielding tables?</p>
</div>
<div id="exercises-13.4.6" class="section level2">
<h2><span class="header-section-number">5.3</span> Exercises 13.4.6</h2>
<p>Compute the average delay by destination, then join on the airports data frame so you can show the spatial distribution of delays. Here’s an easy way to draw a map of the United States:</p>
<p>airports %&gt;%
semi_join(flights, c(“faa” = “dest”)) %&gt;%
ggplot(aes(lon, lat)) +
borders(“state”) +
geom_point() +
coord_quickmap()
(Don’t worry if you don’t understand what semi_join() does — you’ll learn about it next.)</p>
<p>You might want to use the size or colour of the points to display the average delay for each airport.</p>
<p>Add the location of the origin and destination (i.e. the lat and lon) to flights.</p>
<p>Is there a relationship between the age of a plane and its delays?</p>
<p>What weather conditions make it more likely to see a delay?</p>
<p>What happened on June 13 2013? Display the spatial pattern of delays, and then use Google to cross-reference with the weather.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tidy-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r4ds/edit/master/04-relationaldata.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
