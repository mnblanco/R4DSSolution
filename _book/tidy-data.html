<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R for Data Science Solutions</title>
  <meta name="description" content="R for Data Science Solutions">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R for Data Science Solutions" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R for Data Science Solutions" />
  
  
  

<meta name="author" content="Marjorie Blanco">


<meta name="date" content="2018-10-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="data-import.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="r4ds.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">R for Data Science</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="tibble.html"><a href="tibble.html"><i class="fa fa-check"></i><b>2</b> Tibble</a><ul>
<li class="chapter" data-level="2.1" data-path="tibble.html"><a href="tibble.html#exercises"><i class="fa fa-check"></i><b>2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-import.html"><a href="data-import.html"><i class="fa fa-check"></i><b>3</b> Data Import</a><ul>
<li class="chapter" data-level="3.1" data-path="data-import.html"><a href="data-import.html#exercises-1"><i class="fa fa-check"></i><b>3.1</b> Exercises</a></li>
<li class="chapter" data-level="3.2" data-path="data-import.html"><a href="data-import.html#exercises-2"><i class="fa fa-check"></i><b>3.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidy-data.html"><a href="tidy-data.html"><i class="fa fa-check"></i><b>4</b> Tidy data</a><ul>
<li class="chapter" data-level="4.1" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.2.1"><i class="fa fa-check"></i><b>4.1</b> Exercises 12.2.1</a></li>
<li class="chapter" data-level="4.2" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.3.3"><i class="fa fa-check"></i><b>4.2</b> Exercises 12.3.3</a></li>
<li class="chapter" data-level="4.3" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.4.3"><i class="fa fa-check"></i><b>4.3</b> Exercises 12.4.3</a></li>
<li class="chapter" data-level="4.4" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.5.1"><i class="fa fa-check"></i><b>4.4</b> Exercises 12.5.1</a></li>
<li class="chapter" data-level="4.5" data-path="tidy-data.html"><a href="tidy-data.html#exercises-12.6.1"><i class="fa fa-check"></i><b>4.5</b> Exercises 12.6.1</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Data Science Solutions</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy-data" class="section level1">
<h1><span class="header-section-number">4</span> Tidy data</h1>
<div id="exercises-12.2.1" class="section level2">
<h2><span class="header-section-number">4.1</span> Exercises 12.2.1</h2>
<p>Using prose, describe how the variables and observations are organised in
each of the sample tables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">table1</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;   country      year  cases population</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt;</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; 3 Brazil       1999  37737  172006362</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; 4 Brazil       2000  80488  174504898</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; 5 China        1999 212258 1272915272</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; 6 China        2000 213766 1280428583</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">table2</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;   country      year type           count</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;          &lt;int&gt;</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan  1999 cases            745</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan  1999 population  19987071</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; 3 Afghanistan  2000 cases           2666</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">#&gt; 4 Afghanistan  2000 population  20595360</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">#&gt; 5 Brazil       1999 cases          37737</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; 6 Brazil       1999 population 172006362</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; # ... with 6 more rows</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">table3</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;   country      year rate             </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt; * &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan  1999 745/19987071     </span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan  2000 2666/20595360    </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">#&gt; 3 Brazil       1999 37737/172006362  </span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">#&gt; 4 Brazil       2000 80488/174504898  </span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">#&gt; 5 China        1999 212258/1272915272</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; 6 China        2000 213766/1280428583</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">table4a</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt;   country     `1999` `2000`</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; * &lt;chr&gt;        &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan    745   2666</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; 2 Brazil       37737  80488</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; 3 China       212258 213766</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">table5</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; # A tibble: 6 x 4</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt;   country     century year  rate             </span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; * &lt;chr&gt;       &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt; 1 Afghanistan 19      99    745/19987071     </span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt; 2 Afghanistan 20      00    2666/20595360    </span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt; 3 Brazil      19      99    37737/172006362  </span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt; 4 Brazil      20      00    80488/174504898  </span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 5 China       19      99    212258/1272915272</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 6 China       20      00    213766/1280428583</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co">#table6</span></a></code></pre></div>
<p>Compute the rate for table2, and table4a + table4b. You will need to perform four operations:</p>
<p>Compute the <code>rate</code> for <code>table2</code>, and <code>table4a</code> + <code>table4b</code>.
You will need to perform four operations:</p>
<pre><code>Extract the number of TB cases per country per year.
Extract the matching population per country per year.
Divide cases by population, and multiply by 10000.
Store back in the appropriate place.

Which representation is easiest to work with? Which is hardest? Why?</code></pre>
<p>Extract the number of TB cases per country per year.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">t2_cases &lt;-<span class="st"> </span>table2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;cases&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">cases =</span> count )</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">t4_cases &lt;-<span class="st"> </span>table4a <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>, <span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cases&quot;</span>)</a></code></pre></div>
<p>Extract the matching population per country per year.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">t2_pop &lt;-<span class="st"> </span>table2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(type <span class="op">==</span><span class="st"> &quot;population&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>type) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rename</span>(<span class="dt">population =</span> count )</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">t4_pop &lt;-<span class="st"> </span>table4b <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>, <span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;population&quot;</span>)</a></code></pre></div>
<p>Divide cases by population, and multiply by 10000.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">t2_rate &lt;-<span class="st"> </span>t2_cases <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(t2_pop, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">count =</span> (cases <span class="op">/</span><span class="st"> </span>population) <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>cases, <span class="op">-</span>population) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="st">&quot;rate&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(country, year, type, count)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">t4_rate &lt;-<span class="st"> </span>t4_cases <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(t4_pop, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;year&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">count =</span> (cases <span class="op">/</span><span class="st"> </span>population) <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>cases, <span class="op">-</span>population) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="st">&quot;rate&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(country, year, count)</a></code></pre></div>
<p>Store back in the appropriate place.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"></a>
<a class="sourceLine" id="cb12-2" data-line-number="2">table2_new &lt;-<span class="st"> </span><span class="kw">left_join</span>(table2, t2_rate)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="co">#&gt; Joining, by = c(&quot;country&quot;, &quot;year&quot;, &quot;type&quot;, &quot;count&quot;)</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">table2_new</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt; # A tibble: 12 x 4</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt;   country      year type           count</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; 1 Afghanistan  1999 cases            745</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; 2 Afghanistan  1999 population  19987071</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; 3 Afghanistan  2000 cases           2666</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11"><span class="co">#&gt; 4 Afghanistan  2000 population  20595360</span></a>
<a class="sourceLine" id="cb12-12" data-line-number="12"><span class="co">#&gt; 5 Brazil       1999 cases          37737</span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="co">#&gt; 6 Brazil       1999 population 172006362</span></a>
<a class="sourceLine" id="cb12-14" data-line-number="14"><span class="co">#&gt; # ... with 6 more rows</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15"><span class="co">#table2_new &lt;- bind_rows(table2 %&gt;% mutate(count = as.numeric(count)), t2_rate)</span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"></a>
<a class="sourceLine" id="cb12-17" data-line-number="17">table4c &lt;-<span class="st"> </span>t4_rate <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(year, count)</a>
<a class="sourceLine" id="cb12-18" data-line-number="18">table4c</a>
<a class="sourceLine" id="cb12-19" data-line-number="19"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb12-20" data-line-number="20"><span class="co">#&gt;   country     `1999` `2000`</span></a>
<a class="sourceLine" id="cb12-21" data-line-number="21"><span class="co">#&gt;   &lt;chr&gt;        &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb12-22" data-line-number="22"><span class="co">#&gt; 1 Afghanistan  0.373   1.29</span></a>
<a class="sourceLine" id="cb12-23" data-line-number="23"><span class="co">#&gt; 2 Brazil       2.19    4.61</span></a>
<a class="sourceLine" id="cb12-24" data-line-number="24"><span class="co">#&gt; 3 China        1.67    1.67</span></a></code></pre></div>
<p>Recreate the plot showing change in cases over time using <code>table2</code>
instead of <code>table1</code>. What do you need to do first?</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">table1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> cases <span class="op">/</span><span class="st"> </span>population <span class="op">*</span><span class="st"> </span><span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb13-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6 x 5</span></a>
<a class="sourceLine" id="cb13-4" data-line-number="4"><span class="co">#&gt;   country      year  cases population  rate</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5"><span class="co">#&gt;   &lt;chr&gt;       &lt;int&gt;  &lt;int&gt;      &lt;int&gt; &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6"><span class="co">#&gt; 1 Afghanistan  1999    745   19987071 0.373</span></a>
<a class="sourceLine" id="cb13-7" data-line-number="7"><span class="co">#&gt; 2 Afghanistan  2000   2666   20595360 1.29 </span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8"><span class="co">#&gt; 3 Brazil       1999  37737  172006362 2.19 </span></a>
<a class="sourceLine" id="cb13-9" data-line-number="9"><span class="co">#&gt; 4 Brazil       2000  80488  174504898 4.61 </span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10"><span class="co">#&gt; 5 China        1999 212258 1272915272 1.67 </span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11"><span class="co">#&gt; 6 China        2000 213766 1280428583 1.67</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12"></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">table2_s &lt;-<span class="st"> </span>table2_new <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">spread</span>(type, count) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">cases =</span> <span class="kw">as.integer</span>(cases), <span class="dt">population =</span> <span class="kw">as.integer</span>(population))</a>
<a class="sourceLine" id="cb13-14" data-line-number="14"></a>
<a class="sourceLine" id="cb13-15" data-line-number="15">table1 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-16" data-line-number="16"><span class="st">  </span><span class="kw">count</span>(year, <span class="dt">wt =</span> cases)</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb13-18" data-line-number="18"><span class="co">#&gt;    year      n</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19"><span class="co">#&gt;   &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb13-20" data-line-number="20"><span class="co">#&gt; 1  1999 250740</span></a>
<a class="sourceLine" id="cb13-21" data-line-number="21"><span class="co">#&gt; 2  2000 296920</span></a>
<a class="sourceLine" id="cb13-22" data-line-number="22"></a>
<a class="sourceLine" id="cb13-23" data-line-number="23">table2_s <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-24" data-line-number="24"><span class="st">  </span><span class="kw">count</span>(year, <span class="dt">wt =</span> cases)</a>
<a class="sourceLine" id="cb13-25" data-line-number="25"><span class="co">#&gt; # A tibble: 2 x 2</span></a>
<a class="sourceLine" id="cb13-26" data-line-number="26"><span class="co">#&gt;    year      n</span></a>
<a class="sourceLine" id="cb13-27" data-line-number="27"><span class="co">#&gt;   &lt;int&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb13-28" data-line-number="28"><span class="co">#&gt; 1  1999 250740</span></a>
<a class="sourceLine" id="cb13-29" data-line-number="29"><span class="co">#&gt; 2  2000 296920</span></a>
<a class="sourceLine" id="cb13-30" data-line-number="30"></a>
<a class="sourceLine" id="cb13-31" data-line-number="31"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb13-32" data-line-number="32"><span class="kw">ggplot</span>(table1, <span class="kw">aes</span>(year, cases)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-33" data-line-number="33"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country), <span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-34" data-line-number="34"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> country))</a>
<a class="sourceLine" id="cb13-35" data-line-number="35"></a>
<a class="sourceLine" id="cb13-36" data-line-number="36"><span class="kw">ggplot</span>(table2_s, <span class="kw">aes</span>(year, cases)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-37" data-line-number="37"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">group =</span> country), <span class="dt">colour =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-38" data-line-number="38"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> country))</a></code></pre></div>
<p><img src="03-tidydata_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /><img src="03-tidydata_files/figure-html/unnamed-chunk-14-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="exercises-12.3.3" class="section level2">
<h2><span class="header-section-number">4.2</span> Exercises 12.3.3</h2>
<p>Why are <code>gather()</code> and <code>spread()</code> not perfectly symmetrical?<br />
Carefully consider the following example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">stocks &lt;-<span class="st"> </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  <span class="dt">year   =</span> <span class="kw">c</span>(<span class="dv">2015</span>, <span class="dv">2015</span>, <span class="dv">2016</span>, <span class="dv">2016</span>),</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">half  =</span> <span class="kw">c</span>(   <span class="dv">1</span>,    <span class="dv">2</span>,     <span class="dv">1</span>,    <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  <span class="dt">return =</span> <span class="kw">c</span>(<span class="fl">1.88</span>, <span class="fl">0.59</span>, <span class="fl">0.92</span>, <span class="fl">0.17</span>)</a>
<a class="sourceLine" id="cb14-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">stocks <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="st">  </span><span class="kw">spread</span>(year, return) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;return&quot;</span>, <span class="st">`</span><span class="dt">2015</span><span class="st">`</span><span class="op">:</span><span class="st">`</span><span class="dt">2016</span><span class="st">`</span>)</a>
<a class="sourceLine" id="cb14-9" data-line-number="9"><span class="co">#&gt; # A tibble: 4 x 3</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10"><span class="co">#&gt;    half year  return</span></a>
<a class="sourceLine" id="cb14-11" data-line-number="11"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb14-12" data-line-number="12"><span class="co">#&gt; 1     1 2015    1.88</span></a>
<a class="sourceLine" id="cb14-13" data-line-number="13"><span class="co">#&gt; 2     2 2015    0.59</span></a>
<a class="sourceLine" id="cb14-14" data-line-number="14"><span class="co">#&gt; 3     1 2016    0.92</span></a>
<a class="sourceLine" id="cb14-15" data-line-number="15"><span class="co">#&gt; 4     2 2016    0.17</span></a></code></pre></div>
<pre><code>(Hint: look at the variable types and think about column _names_.)

Both `spread()` and `gather()` have a `convert` argument. What does it 
do?</code></pre>
<p>Why does this code fail?</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">table4a <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">gather</span>(<span class="st">`</span><span class="dt">1999</span><span class="st">`</span>, <span class="st">`</span><span class="dt">2000</span><span class="st">`</span>, <span class="dt">key =</span> <span class="st">&quot;year&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cases&quot;</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="co">#&gt; # A tibble: 6 x 3</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4"><span class="co">#&gt;   country     year   cases</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5"><span class="co">#&gt;   &lt;chr&gt;       &lt;chr&gt;  &lt;int&gt;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt; 1 Afghanistan 1999     745</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; 2 Brazil      1999   37737</span></a>
<a class="sourceLine" id="cb16-8" data-line-number="8"><span class="co">#&gt; 3 China       1999  212258</span></a>
<a class="sourceLine" id="cb16-9" data-line-number="9"><span class="co">#&gt; 4 Afghanistan 2000    2666</span></a>
<a class="sourceLine" id="cb16-10" data-line-number="10"><span class="co">#&gt; 5 Brazil      2000   80488</span></a>
<a class="sourceLine" id="cb16-11" data-line-number="11"><span class="co">#&gt; 6 China       2000  213766</span></a></code></pre></div>
<p>Why does spreading this tibble fail? How could you add a new column to fix
the problem?</p>
<p>Phillip Woods has two record for his age (45 and 50).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">people &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="op">~</span>name,             <span class="op">~</span>key,    <span class="op">~</span>value,</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">  <span class="co">#-----------------|--------|------</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;age&quot;</span>,       <span class="dv">45</span>,</a>
<a class="sourceLine" id="cb17-5" data-line-number="5">  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;height&quot;</span>,   <span class="dv">186</span>,</a>
<a class="sourceLine" id="cb17-6" data-line-number="6">  <span class="st">&quot;Phillip Woods&quot;</span>,   <span class="st">&quot;age&quot;</span>,       <span class="dv">50</span>,</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;age&quot;</span>,       <span class="dv">37</span>,</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">  <span class="st">&quot;Jessica Cordero&quot;</span>, <span class="st">&quot;height&quot;</span>,   <span class="dv">156</span></a>
<a class="sourceLine" id="cb17-9" data-line-number="9">)</a>
<a class="sourceLine" id="cb17-10" data-line-number="10"></a>
<a class="sourceLine" id="cb17-11" data-line-number="11">people <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-12" data-line-number="12"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-13" data-line-number="13"><span class="st">  </span><span class="kw">select</span>(id, <span class="kw">everything</span>()) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-14" data-line-number="14"><span class="st">  </span><span class="kw">spread</span>(key, value)</a>
<a class="sourceLine" id="cb17-15" data-line-number="15"><span class="co">#&gt; # A tibble: 3 x 4</span></a>
<a class="sourceLine" id="cb17-16" data-line-number="16"><span class="co">#&gt;      id name              age height</span></a>
<a class="sourceLine" id="cb17-17" data-line-number="17"><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb17-18" data-line-number="18"><span class="co">#&gt; 1     1 Phillip Woods      45     NA</span></a>
<a class="sourceLine" id="cb17-19" data-line-number="19"><span class="co">#&gt; 2     2 Phillip Woods      50    186</span></a>
<a class="sourceLine" id="cb17-20" data-line-number="20"><span class="co">#&gt; 3     3 Jessica Cordero    37    156</span></a></code></pre></div>
<p>Tidy the simple tibble below. Do you need to spread or gather it?
What are the variables?</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">preg &lt;-<span class="st"> </span><span class="kw">tribble</span>(</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="op">~</span>pregnant, <span class="op">~</span>male, <span class="op">~</span>female,</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">  <span class="st">&quot;yes&quot;</span>,     <span class="ot">NA</span>,    <span class="dv">10</span>,</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  <span class="st">&quot;no&quot;</span>,      <span class="dv">20</span>,    <span class="dv">12</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb18-6" data-line-number="6"></a>
<a class="sourceLine" id="cb18-7" data-line-number="7">preg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="st">  </span><span class="kw">gather</span>(<span class="st">`</span><span class="dt">male</span><span class="st">`</span>, <span class="st">`</span><span class="dt">female</span><span class="st">`</span>, <span class="dt">key =</span> <span class="st">&quot;sex&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;count&quot;</span>)</a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; # A tibble: 4 x 3</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt;   pregnant sex    count</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;  &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; 1 yes      male      NA</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; 2 no       male      20</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; 3 yes      female    10</span></a>
<a class="sourceLine" id="cb18-15" data-line-number="15"><span class="co">#&gt; 4 no       female    12</span></a></code></pre></div>
</div>
<div id="exercises-12.4.3" class="section level2">
<h2><span class="header-section-number">4.3</span> Exercises 12.4.3</h2>
<p>What do the <code>extra</code> and <code>fill</code> arguments do in <code>separate()</code>?
Experiment with the various options for the following two toy datasets.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;a,b,c&quot;</span>, <span class="st">&quot;d,e,f,g&quot;</span>, <span class="st">&quot;h,i,j&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">separate</span>(x, <span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>))</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="co">#&gt; Warning: Expected 3 pieces. Additional pieces discarded in 1 rows [2].</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="co">#&gt;   one   two   three</span></a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7"><span class="co">#&gt; 1 a     b     c    </span></a>
<a class="sourceLine" id="cb19-8" data-line-number="8"><span class="co">#&gt; 2 d     e     f    </span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9"><span class="co">#&gt; 3 h     i     j</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10"></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="kw">c</span>(<span class="st">&quot;a,b,c&quot;</span>, <span class="st">&quot;d,e&quot;</span>, <span class="st">&quot;f,g,i&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="st">  </span><span class="kw">separate</span>(x, <span class="kw">c</span>(<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>))</a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt; Warning: Expected 3 pieces. Missing pieces filled with `NA` in 1 rows [2].</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; # A tibble: 3 x 3</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co">#&gt;   one   two   three</span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt;   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;</span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">#&gt; 1 a     b     c    </span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="co">#&gt; 2 d     e     &lt;NA&gt; </span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="co">#&gt; 3 f     g     i</span></a></code></pre></div>
<p>Both <code>unite()</code> and <code>separate()</code> have a <code>remove</code> argument. What does it
do? Why would you set it to <code>FALSE</code>?</p>
<p>Compare and contrast <code>separate()</code> and <code>extract()</code>. Why are there
three variations of separation (by position, by separator, and with
groups), but only one unite?</p>
</div>
<div id="exercises-12.5.1" class="section level2">
<h2><span class="header-section-number">4.4</span> Exercises 12.5.1</h2>
<p>Compare and contrast the fill arguments to spread() and complete().</p>
<p>What does the direction argument to fill() do?</p>
</div>
<div id="exercises-12.6.1" class="section level2">
<h2><span class="header-section-number">4.5</span> Exercises 12.6.1</h2>
<p>In this case study I set na.rm = TRUE just to make it easier to check that we had the correct values. Is this reasonable? Think about how missing values are represented in this dataset. Are there implicit missing values? What’s the difference between an NA and zero?</p>
<p>What happens if you neglect the mutate() step? (mutate(key = stringr::str_replace(key, “newrel”, “new_rel”)))</p>
<p>I claimed that iso2 and iso3 were redundant with country. Confirm this claim.</p>
<p>For each country, year, and sex compute the total number of cases of TB. Make an informative visualisation of the data.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-import.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hadley/r4ds/edit/master/03-tidydata.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
